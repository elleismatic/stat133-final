industries_only <- raw_data[-which(raw_data$Industry == "Unclassified" | raw_data$Industry == "Total Market"),]
symbols(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
circles = industries_only$Number.of.firms, fg="white",
bg="pink", xlab="Current PE", ylab="Expected Growth in 5 Years")
text(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
cex = 0.2)
?symbols
symbols(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
circles = industries_only$Number.of.firms, fg="white",
bg=rgba(255,204,204,0.3), xlab="Current PE", ylab="Expected Growth in 5 Years")
text(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
cex = 0.2)
symbols(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
circles = industries_only$Number.of.firms, fg="white",
bg=rgba(255,204,204,0.3), xlab="Current PE", ylab="Expected Growth in 5 Years")
symbols(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
circles = industries_only$Number.of.firms, fg="white",
bg=rgba(255,204,204,0.5), xlab="Current PE", ylab="Expected Growth in 5 Years")
?rgba
??rgba
??rgb
??alpha
symbols(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
circles = industries_only$Number.of.firms, fg="white",
bg=alpha(rgb(255,204,204),0.5), xlab="Current PE", ylab="Expected Growth in 5 Years")
text(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
cex = 0.2)
?alpha
alpha("red", 0.1)
symbols(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
circles = industries_only$Number.of.firms, fg="white",
bg=rgb(255,204,204), xlab="Current PE", ylab="Expected Growth in 5 Years")
text(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
cex = 0.2)
symbols(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
circles = industries_only$Number.of.firms, fg="white",
bg="pink", xlab="Current PE", ylab="Expected Growth in 5 Years")
text(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
cex = 0.2)
symbols(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
circles = industries_only$Number.of.firms, inches=0.35 fg="white",
bg="pink", xlab="Current PE", ylab="Expected Growth in 5 Years")
text(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
symbols(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
circles = industries_only$Number.of.firms, inches=0.35, fg="white",
bg="pink", xlab="Current PE", ylab="Expected Growth in 5 Years")
text(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
cex = 0.2)
symbols(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
circles = industries_only$Number.of.firms, inches=0.35, fg="white",
bg="pink", xlab="Current PE", ylab="Expected Growth in 5 Years")
text(industries_only$Current.PE, industries_only$Expected.growth.in.next.5.years,
cex = 0.2)
ggplot(data = raw_data) +
geom_line(aes(x = Current.PE, y = Expected.growth.in.next.5.years))
ggplot(data = raw_data) +
geom_line(aes(x = Current.PE, y = Expected.growth.in.next.5.years))
library(ggplot2)
dev.off()
beta <- read.csv("~/Documents/UC\ Berkeley\ 2015-2016/Statistics\ 133/projects/final/total_beta.csv", header = TRUE)
pe <- read.csv("~/Documents/UC\ Berkeley\ 2015-2016/Statistics\ 133/projects/final/PE_data.csv", header = TRUE)
beta <- read.csv("http://people.stern.nyu.edu/adamodar/New_Home_Page/datafile/pedata.html", header = TRUE)
beta <- read.csv("http://people.stern.nyu.edu/adamodar/New_Home_Page/datafile/totalbeta.html", header = TRUE)
pe <- read.csv("http://people.stern.nyu.edu/adamodar/New_Home_Page/datafile/pedata.html", header = TRUE)
raw_data <- merge(beta, pe, by = intersect(names(beta), names(pe)))
str(raw_data)
View(beta)
beta <- read.csv("http://www.stern.nyu.edu/~adamodar/pc/datasets/totalbeta.xls", header = TRUE)
pe <- read.csv("http://www.stern.nyu.edu/~adamodar/pc/datasets/pedata.xls", header = TRUE)
beta <- read.csv("http://www.stern.nyu.edu/~adamodar/pc/datasets/totalbeta.xls", header = TRUE)
beta <- read.csv("~/Documents/UC\ Berkeley\ 2015-2016/Statistics\ 133/projects/final/total_beta.csv", header = TRUE)
pe <- read.csv("~/Documents/UC\ Berkeley\ 2015-2016/Statistics\ 133/projects/final/PE_data.csv", header = TRUE)
str(raw_data)
setwd("~/Documents/UC\ Berkeley\ 2015-2016/Statistics\ 133/projects/final/")
beta <- read.csv("raw_data/total_beta.csv", header = TRUE,  stringsAsFactors = FALSE)
pe <- read.csv("raw_data/pe_data.csv", header = TRUE, stringsAsFactors = FALSE)
raw_data <- merge(beta, pe, by = intersect(names(beta), names(pe)))
str(raw_data)
setwd("~/Documents/UC\ Berkeley\ 2015-2016/Statistics\ 133/projects/final/")
library(ggplot2)
dev.off()
library(readr)
library(scatterplot3d)
library(stringr)
clean_data <- read.csv("clean_data/clean_data.csv", header = TRUE,
stringsAsFactors = FALSE)
industries_only <- read.csv("clean_data/industries_only.csv", header = TRUE,
stringsAsFactors = FALSE)
dat2 <- data.frame(beta = clean_data$Average.Unlevered.Beta,
growth = clean_data$Expected.Growth.Next.5.Years)
ggplot(dat2, aes(x = beta, y = growth)) +
geom_bar(position = "identity", stat = "identity") +
ggtitle("Beta vs Expected Growth Rate") +
theme_classic()
industry_pe <- unlist(sort(industries_only$Current.PE, decreasing = TRUE))
industry_indices <- unlist(sort(industries_only$Current.PE, decreasing = TRUE,
index.return = TRUE)[[2]])
industry_growth <- industries_only$
Expected.Growth.Next.5.Years[industry_indices]
industry_num_firms <- industries_only$Number.of.Firms[industry_indices]
industry_pe_growth <- data.frame(pe = industry_pe, growth = industry_growth,
num_firms = industry_num_firms)
dat6 <- subset(industry_pe_growth, industry_pe < 150)
symbols(dat6$pe, dat6$growth, circles = dat6$num_firms,
inches=0.35, fg="white", bg="#facccc8d",
xlab="Current PE", ylab="Expected Growth in 5 Years",
main = paste("Current PE Less Than 150 vs",
"Expected Growth in the Next 5 Years"))
text(dat6$pe, dat6$growth, labels = dat6$num_firms, cex = 0.3)
reg3 <- lm(Expected.Growth.Next.5.Years ~ Average.Unlevered.Beta +
Current.PE + PEG.Ratio, data = clean_data)
summary(reg3)
ggplot(clean_data, aes(x = Current.PE,
y = Expected.Growth.Next.5.Years)) +
geom_point(color = rgb(223, 84, 84, 100, maxColorValue = 255)) +
xlab("Current PE Ratio") + ylab("Expected Growth (%)") +
geom_abline(aes(slope = unname(coef(reg3)["Average.Unlevered.Beta"]),
intercept = unname(coef(reg3)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("PEG Ratio's Impact on Expected Growth") +
theme_classic()
reg4 <- lm(Expected.Growth.Next.5.Years ~ PEG.Ratio, data = clean_data)
summary(reg4)
ggplot(clean_data, aes(x = PEG.Ratio,
y = Expected.Growth.Next.5.Years)) +
geom_point(color = rgb(223, 84, 84, 100, maxColorValue = 255)) +
xlab("PEG Ratio") + ylab("Expected Growth (%)") +
geom_abline(aes(slope = unname(coef(reg3)["PEG.Ratio"]),
intercept = unname(coef(reg3)["(Intercept)"])),
color = rgb(84, 233, 233, maxColorValue = 255)) +
geom_abline(aes(slope = unname(coef(reg4)["PEG.Ratio"]),
intercept = unname(coef(reg4)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("PEG Ratio's Impact on Expected Growth") +
theme_classic()
ggplot(clean_data, aes(x = Average.Unlevered.Beta,
y = Expected.Growth.Next.5.Years)) +
geom_point() + xlab("Average Unlevered Beta") + ylab("Expected Growth (%)") +
ggtitle("Scatterplot of Average Unlevered Beta vs Expected Growth") +
theme_classic()
ggplot(clean_data, aes(x = PEG.Ratio,
y = Expected.Growth.Next.5.Years)) +
geom_point(color = rgb(223, 84, 84, 100, maxColorValue = 255)) +
xlab("PEG Ratio") + ylab("Expected Growth (%)") +
geom_abline(aes(slope = unname(coef(reg3)["PEG.Ratio"]),
intercept = unname(coef(reg3)["(Intercept)"])),
color = rgb(84, 233, 233, maxColorValue = 255)) +
geom_abline(aes(slope = unname(coef(reg4)["PEG.Ratio"]),
intercept = unname(coef(reg4)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("PEG Ratio's Impact on Expected Growth") +
theme_classic()
ggplot(clean_data, aes(x = PEG.Ratio,
y = Expected.Growth.Next.5.Years)) +
geom_point(color = rgb(223, 84, 84, 100, maxColorValue = 255)) +
xlab("PEG Ratio") + ylab("Expected Growth (%)") +
geom_abline(aes(slope = unname(coef(reg4)["PEG.Ratio"]),
intercept = unname(coef(reg4)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("PEG Ratio's Impact on Expected Growth") +
theme_classic()
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
clean_data$PEG.Ratio, z = clean_data$Average.Unlevered.Beta,
angle = 30, scale.y = .3,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta")
# Look at PE Ratio here:
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
clean_data$PEG.Ratio, z = clean_data$Average.Unlevered.Beta,
angle = 280, scale.y = .3,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 200, scale.y = .3,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y= clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 230, scale.y = .3,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = -400, scale.y = .3,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y= clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 200, scale.y = .3,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
clean_data$PEG.Ratio, z = clean_data$Average.Unlevered.Beta,
angle = 30, scale.y = .3,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
clean_data$PEG.Ratio, z = clean_data$Average.Unlevered.Beta,
angle = 30, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(223, 84, 84, 100, maxColorValue = 255))
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
clean_data$PEG.Ratio, z = clean_data$Average.Unlevered.Beta,
angle = 30, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(223, 223, 84, 100, maxColorValue = 255))
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
clean_data$PEG.Ratio, z = clean_data$Average.Unlevered.Beta,
angle = 30, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255))
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
clean_data$PEG.Ratio, z = clean_data$Average.Unlevered.Beta,
angle = 30, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
reg5 <- lm(Expected.Growth.Next.5.Years ~ PEG.Ratio + Average.Unlvered.Beta,
data = clean_data)
summary(reg5)
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
clean_data$PEG.Ratio, z = clean_data$Average.Unlevered.Beta,
reg5 <- lm(Expected.Growth.Next.5.Years ~ PEG.Ratio + Average.Unlevered.Beta,
data = clean_data)
summary(reg5)
reg5 <- lm(Expected.Growth.Next.5.Years ~ PEG.Ratio + Average.Unlevered.Beta,
data = clean_data)
summary(reg5)
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
clean_data$PEG.Ratio, z = clean_data$Average.Unlevered.Beta,
angle = 30, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
abline(reg5, col = rgb(83, 223, 223, maxColorValue = 255))
?scatterplot3d
?points3d
points3d(reg5, col = rgb(83, 223, 223, maxColorValue = 255))
library("points3d")
library(points3d)
plane3d(reg5, col = rgb(83, 223, 223, maxColorValue = 255))
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
clean_data$PEG.Ratio, z = clean_data$Average.Unlevered.Beta,
angle = 30, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
clean_data$PEG.Ratio, z = clean_data$Average.Unlevered.Beta,
angle = 280, scale.y = .3,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 200, scale.y = .3,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
clean_data$Current.PE, z = clean_data$Average.Unlevered.Beta,
angle = 30, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "Current PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PE Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
clean_data$PEG.Ratio, z = clean_data$Average.Unlevered.Beta,
angle = 300, scale.y = .3,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 30, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 300, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 20, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 200, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 180, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 230, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 250, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 210, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 245, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 345, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 250, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 245, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PE Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 300, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PEG Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 245, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PEG Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 400, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PEG Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = 100, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PEG Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$PEG.Ratio,
z = clean_data$Average.Unlevered.Beta,
angle = -400, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "PEG Ratio", zlab = "Beta",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
scatterplot3d(x = clean_data$Expected.Growth.Next.5.Years,
y = clean_data$Average.Unlevered.Beta,
z = clean_data$PEG.Ratio,
angle = 100, scale.y = .3, pch = 16,
xlab = "Expected Growth in Next 5 Years",
ylab = "Beta", zlab = "PEG Ratio",
color = rgb(83, 223, 223, 100, maxColorValue = 255),
main = "3D Scatterplot of Expected Growth, PEG Ratio, and Beta")
industry_pe <- unlist(sort(industries_only$Current.PE, decreasing = TRUE))
industry_indices <- unlist(sort(industries_only$Current.PE, decreasing = TRUE,
index.return = TRUE)[[2]])
industry_growth <- industries_only$
Expected.Growth.Next.5.Years[industry_indices]
industry_num_firms <- industries_only$Number.of.Firms[industry_indices]
industry_pe_growth <- data.frame(pe = industry_pe, growth = industry_growth,
num_firms = industry_num_firms)
dat6 <- subset(industry_pe_growth, industry_pe < 150)
symbols(dat6$pe, dat6$growth, circles = dat6$num_firms,
inches=0.35, fg="white", bg="#facccc8d",
xlab="Current PE", ylab="Expected Growth in 5 Years",
main = paste("Current PE Less Than 150 vs",
"Expected Growth in the Next 5 Years"))
text(dat6$pe, dat6$growth, labels = dat6$num_firms, cex = 0.3)
symbols(industries_only$Current.PE,
industries_only$Expected.Growth.Next.5.Years,
circles = industries_only$Number.of.Firms,
inches = 0.35, fg="white", bg="#facccc8d",
xlab="Current PE", ylab="Expected Growth in 5 Years",
main = "Current PE vs Expected Growth in the Next 5 Years")
text(industries_only$Current.PE, industries_only$Expected.Growth.Next.5.Years,
labels = industries_only$Number.of.Firms, cex = 0.2)
View(clean_data)
print(clean_data$Industry[sorted_beta][(cutoff+1):end])
barplot(clean_data$Current.PE, border = NA, xlab = "Current PE", ylab = "Frequency",
col = rgb(200, 100, 100, 100, maxColorValue = 255),
main = "Bar Plot of Current PE Ratio")
dfbeta_interval <- data.frame(table(unlist(beta_interval)))
names(dfbeta_interval) <- c("Interval", "Frequency")
hist(beta_interval, main = "Histogram of Beta Intevals",
xlab = "Beta intervals", col = rgb(200, 50, 150, 100, maxColorValue = 255),
border = NA)
View(clean_data)
dat1 <- data.frame(PE = industries_only$Current.PE,
beta = industries_only$Average.Unlevered.Beta)
ggplot(dat1, aes(x = beta, y = PE)) +
geom_line(stat = "identity", color = beta_interval) +
ggtitle("Beta vs PE Ratio") + theme_classic() +
scale_x_continuous(breaks = beta_intervals) +
scale_y_continuous(breaks = seq(from = 0, to = 1500, by = 100))
summary(industries_only$Current.PE)
dat1 <- data.frame(PE = industries_only$Current.PE,
beta = industries_only$Average.Unlevered.Beta)
ggplot(dat1, aes(x = beta, y = PE)) +
geom_line(stat = "identity", color = beta_interval) +
ggtitle("Beta vs PE Ratio") + theme_classic() +
scale_x_continuous(breaks = beta_intervals) +
scale_y_continuous(breaks = seq(from = 0, to = 1500, by = 100))
dfbeta_interval <- data.frame(table(unlist(beta_interval)))
names(dfbeta_interval) <- c("Interval", "Frequency")
hist(beta_interval, main = "Histogram of Beta Intevals",
xlab = "Beta intervals", col = rgb(200, 50, 150, 100, maxColorValue = 255),
border = NA)
beta_intervals <- seq(from = 0, to = 1.5, by = 0.3)
interval_fun <- function(beta) {
for (i in 1:5) {
if (beta_intervals[i] < beta & beta < beta_intervals[i + 1]) {
return (i)
}
}
}
beta_interval <- unlist(lapply(clean_data$Average.Unlevered.Beta,
FUN = interval_fun))
as.vector(clean_data$Industry[unlist(beta_interval) == 5])
as.vector(clean_data$Industry[unlist(beta_interval) == 1])
# Make a histogram of the beta intervals created above
dfbeta_interval <- data.frame(table(unlist(beta_interval)))
names(dfbeta_interval) <- c("Interval", "Frequency")
hist(beta_interval, main = "Histogram of Beta Intevals",
xlab = "Beta intervals", col = rgb(200, 50, 150, 100, maxColorValue = 255),
border = NA)
# Plot of Beta versus PE Ratio by given beta intervals
dat1 <- data.frame(PE = industries_only$Current.PE,
beta = industries_only$Average.Unlevered.Beta)
ggplot(dat1, aes(x = beta, y = PE)) +
geom_line(stat = "identity", color = beta_interval) +
ggtitle("Beta vs PE Ratio") + theme_classic() +
scale_x_continuous(breaks = beta_intervals) +
scale_y_continuous(breaks = seq(from = 0, to = 1500, by = 100))
summary(industries_only$Current.PE)
dat2 <- data.frame(beta = clean_data$Average.Unlevered.Beta,
growth = clean_data$Expected.Growth.Next.5.Years)
ggplot(dat2, aes(x = beta, y = growth)) +
geom_bar(position = "identity", stat = "identity") +
ggtitle("Beta vs Expected Growth Rate") +
theme_classic()
