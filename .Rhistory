geom_abline(aes(slope = unname(coef(reg2_no_outliers)["dat7$pe"]),
intercept = unname(coef(reg2_no_outliers)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("Current PE Ratio's Impact on Expected Growth")
reg3 <- lm(Expected.Growth.Next.5.Years ~ Average.Unlevered.Beta +
Current.PE + PEG.Ratio, data = clean_data)
summary(reg3)
ggplot(clean_data, aes(x = Current.PE,
y = Expected.Growth.Next.5.Years)) +
geom_point() + xlab("Current PE Ratio") + ylab("Expected Growth (%)") +
geom_abline(aes(slope = unname(coef(reg3)["PEG.Ratio"]),
intercept = unname(coef(reg3)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("Current PE Ratio's Impact on Expected Growth") +
theme_classic()
coef(reg3)
ggplot(clean_data, aes(x = PEG.Ratio, y = Expected.Growth.Next.5.Years)) +
geom_point() + xlab("Current PE Ratio") + ylab("Expected Growth (%)") +
geom_abline(aes(slope = unname(coef(reg3)["PEG.Ratio"]),
intercept = unname(coef(reg3)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("Current PE Ratio's Impact on Expected Growth") +
theme_classic()
reg4 <- lm(Expected.Growth.Next.5.Years ~ PEG.Ratio, data = clean_data)
summary(reg4)
ggplot(clean_data, aes(x = PEG.Ratio, y = Expected.Growth.Next.5.Years)) +
geom_point(color = rgb(223, 84, 84, 100, maxColorValue = 255)) +
xlab("PEG Ratio") + ylab("Expected Growth (%)") +
geom_abline(aes(slope = unname(coef(reg3)["PEG.Ratio"]),
intercept = unname(coef(reg3)["(Intercept)"])),
color = rgb(84, 233, 233, maxColorValue = 255)) +
geom_abline(aes(slope = unname(coef(reg4)["PEG.Ratio"]),
intercept = unname(coef(reg4)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("PEG Ratio's Impact on Expected Growth") + theme_classic()
ggplot(clean_data, aes(x = PEG.Ratio,
y = Expected.Growth.Next.5.Years)) +
geom_point() + xlab("PEG Ratio") + ylab("Expected Growth (%)") +
geom_abline(aes(slope = unname(coef(reg4)["PEG.Ratio"]),
intercept = unname(coef(reg4)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("PEG Ratio's Impact on Expected Growth") + coord_cartesian(ylim=c(0,40)) + theme_classic()
ggplot(clean_data, aes(x = PEG.Ratio, y = Expected.Growth.Next.5.Years)) +
geom_point(color = rgb(223, 84, 84, 100, maxColorValue = 255)) +
xlab("PEG Ratio") + ylab("Expected Growth (%)") +
geom_abline(aes(slope = unname(coef(reg3)["PEG.Ratio"]),
intercept = unname(coef(reg3)["(Intercept)"])),
color = rgb(84, 233, 233, maxColorValue = 255)) +
geom_abline(aes(slope = unname(coef(reg4)["PEG.Ratio"]),
intercept = unname(coef(reg4)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("PEG Ratio's Impact on Expected Growth") + theme_classic()
ggplot(clean_data, aes(x = PEG.Ratio, y = Expected.Growth.Next.5.Years)) +
geom_point(color = rgb(223, 84, 84, 100, maxColorValue = 255)) +
xlab("PEG Ratio") + ylab("Expected Growth (%)") +
geom_abline(aes(slope = unname(coef(reg3)["PEG.Ratio"]),
intercept = unname(coef(reg3)["(Intercept)"])),
color = rgb(84, 233, 233, maxColorValue = 255)) +
geom_abline(aes(slope = unname(coef(reg4)["PEG.Ratio"]),
intercept = unname(coef(reg4)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("PEG Ratio's Impact on Expected Growth") +
coord_cartesian(ylim=c(0,40)) + theme_classic()
peg_no_outliers <- clean_data$PEG.Ratio[indices_no_outliers]
peg_no_outliers
sort(peg_no_outliers)
NA == NA
is.na(NA)
peg_no_outliers <- clean_data$PEG.Ratio[indices_no_outliers]
dat8 <- data.frame(growth = growth_no_outliers, peg = peg_no_outliers)
dat8 <- subset(dat8, growth_no_outliers > 6.32 & peg_no_outliers < 9.28 &
!is.na(peg_no_outliers))
dat8
reg4_no_outliers <- lm(growth ~ peg, data = dat8)
summary(reg4_no_outliers)
coef(reg4_no_outliers)
reg4_no_outliers <- lm(growth ~ peg, data = dat8)
summary(reg4_no_outliers)
ggplot(dat8, aes(x = peg, y = growth)) + xlab("PEG Ratio") +
ylab("Expected Growth (%)") + coord_cartesian(ylim=c(0,40)) +
geom_point(color = rgb(223, 84, 84, 100, maxColorValue = 255)) +
geom_abline(aes(slope = unname(coef(reg4_no_outliers)["peg"]),
intercept = unname(coef(reg4_no_outliers)["(Intercept)"])),
color = rgb(84, 233, 233, maxColorValue = 255)) +
ggtitle("PEG Ratio's Impact on Expected Growth") + theme_classic()
ggplot(dat8, aes(x = peg, y = growth)) + xlab("PEG Ratio") +
ylab("Expected Growth (%)") + coord_cartesian(ylim=c(0,40)) +
geom_point(color = rgb(223, 84, 84, 100, maxColorValue = 255)) +
geom_abline(aes(slope = unname(coef(reg4_no_outliers)["peg"]),
intercept = unname(coef(reg4_no_outliers)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("PEG Ratio's Impact on Expected Growth") + theme_classic()
dat8 <- subset(dat8, growth_no_outliers > 6.32 & peg_no_outliers < 3 &
!is.na(peg_no_outliers))
reg4_no_outliers <- lm(growth ~ peg, data = dat8)
summary(reg4_no_outliers)
ggplot(dat8, aes(x = peg, y = growth)) + xlab("PEG Ratio") +
ylab("Expected Growth (%)") + coord_cartesian(ylim=c(0,40)) +
geom_point(color = rgb(223, 84, 84, 100, maxColorValue = 255)) +
geom_abline(aes(slope = unname(coef(reg4_no_outliers)["peg"]),
intercept = unname(coef(reg4_no_outliers)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("PEG Ratio's Impact on Expected Growth") + theme_classic()
peg_no_outliers <- clean_data$PEG.Ratio[indices_no_outliers]
dat8 <- data.frame(growth = growth_no_outliers, peg = peg_no_outliers)
dat8 <- subset(dat8, growth_no_outliers > 6.32 & peg_no_outliers < 2.5 &
!is.na(peg_no_outliers))
reg4_no_outliers <- lm(growth ~ peg, data = dat8)
summary(reg4_no_outliers)
ggplot(dat8, aes(x = peg, y = growth)) + xlab("PEG Ratio") +
ylab("Expected Growth (%)") + coord_cartesian(ylim=c(0,40)) +
geom_point(color = rgb(223, 84, 84, 100, maxColorValue = 255)) +
geom_abline(aes(slope = unname(coef(reg4_no_outliers)["peg"]),
intercept = unname(coef(reg4_no_outliers)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("PEG Ratio's Impact on Expected Growth") + theme_classic()
sorted_beta <- sort(clean_data$Average.Unlevered.Beta,
index.return = TRUE)[[2]]
sort_beta <- sort(clean_data$Average.Unlevered.Beta)
sorted_growth1 <- clean_data$Expected.Growth.Next.5.Years[sorted_beta]
sorted_beta_growth <- data.frame(beta = sort_beta, growth = sorted_growth1)
new_dat <- subset(sorted_beta_growth, sorted_growth1 > 0)
plot(new_dat$growth, new_dat$beta,
col = rgb(100, 100, 100, 150, maxColorValue = 255), pch = 16,
bg = rgb(200, 200, 200, maxColorValue = 255),
xlab = "growth", ylab = "beta", main = "Beta vs Growth")
fit_growth_beta <- lm(beta ~ growth, data = new_dat)
abline(fit_growth_beta, col = rgb(100, 100, 100, maxColorValue = 255))
summary(fit_growth_beta)
sorted_beta <- sort(clean_data$Average.Unlevered.Beta,
index.return = TRUE)[[2]]
sort_beta <- sort(clean_data$Average.Unlevered.Beta)
sorted_growth1 <- clean_data$Expected.Growth.Next.5.Years[sorted_beta]
sorted_beta_growth <- data.frame(beta = sort_beta, growth = sorted_growth1)
dat3 <- subset(sorted_beta_growth, sorted_growth1 > 0)
plot(dat3$growth, dat3$beta,
col = rgb(100, 100, 100, 150, maxColorValue = 255), pch = 16,
bg = rgb(200, 200, 200, maxColorValue = 255),
xlab = "growth", ylab = "beta", main = "Beta vs Growth")
fit_growth_beta <- lm(beta ~ growth, data = dat3)
abline(fit_growth_beta, col = rgb(100, 100, 100, maxColorValue = 255))
summary(fit_growth_beta)
indices_no_outliers <- sort(clean_data$Expected.Growth.Next.5.Years,
index.return = TRUE)[[2]]
growth_no_outliers <- unlist(sort(clean_data$Expected.Growth.Next.5.Years))
pe_no_outliers <- clean_data$Current.PE[indices_no_outliers]
dat8 <- data.frame(growth = growth_no_outliers, pe = pe_no_outliers)
dat8 <- subset(dat8, growth_no_outliers > 6.32 & pe_no_outliers < 300)
reg2_no_outliers <- lm(growth ~ pe , data = dat8)
summary(reg2_no_outliers)
ggplot(dat8, aes(x = pe, y = growth)) + theme_classic() +
geom_point() + xlab("Current PE Ratio") + ylab("Expected Growth (%)") +
geom_abline(aes(slope = unname(coef(reg2_no_outliers)["pe"]),
intercept = unname(coef(reg2_no_outliers)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("Current PE Ratio's Impact on Expected Growth")
plot(density(clean_data$Current.PE), main = "Density Plot of Current PE")
plot(density(clean_data$Expected.Growth.Next.5.Years),
main = "Density Plot of Expected Growth in the Next 5 Years")
plot(clean_data$Current.PE, clean_data$Expected.Growth.Next.5.Years,
col = rgb(50, 200, 200, 100, maxColorValue = 255), pch = 16,
bg = rgb(200, 200, 200, maxColorValue = 255),
main = "Bar Plot of Forward PE Ratio")
fit1 <- lm(Expected.Growth.Next.5.Years ~ Current.PE, data = clean_data)
abline(fit1, col = rgb(50, 200, 200, maxColorValue = 255))
summary(fit1)
sorted_pe <- sort(clean_data$Current.PE, decreasing = TRUE,
index.return = TRUE)[[2]]
sort_pe <- sort(clean_data$Current.PE, decreasing = TRUE)
sorted_growth2 <- clean_data$Expected.Growth.Next.5.Years[sorted_pe]
sorted_pe_growth <- data.frame(pe = sort_pe, growth = sorted_growth2)
dat4 <- subset(sorted_pe_growth, sort_pe < 300)
plot(dat4$pe, dat4$growth, main = "Current PE Ratio vs. Expected Growth",
xlab = "Current PE ratio", ylab = "Expected growth (next 5 years)",
col = rgb(200, 50, 200, 100, maxColorValue = 255), pch = 16)
fit2 <- lm(growth ~ pe, data = dat4)
abline(fit2, col = rgb(200, 50, 200, maxColorValue = 255))
summary(fit2)
beta_pe <- clean_data$Current.PE[sorted_beta]
beta_growth <- clean_data$Expected.Growth.Next.5.Years[sorted_beta]
end <- length(beta_pe)
cutoff <- round(end/2)
beta1 <- data.frame(pe = beta_pe[1:cutoff], growth = beta_growth[1:cutoff])
plot(beta1$pe, beta1$growth,
main = paste("Current PE Ratio vs. Expected Growth",
"For Industries with Lower Beta"),
xlab = "Current PE ratio", ylab = "Expected growth (next 5 years)",
col = rgb(50, 50, 200, 100, maxColorValue = 255), pch = 16)
fit3 <- lm(growth ~ pe, data = beta1)
abline(fit3, col = rgb(50, 50, 200, maxColorValue = 255))
summary(fit3)
ggplot(data = clean_data, aes(x = Current.PE,
y = Expected.Growth.Next.5.Years)) +
geom_line(color = "#548edf") + xlab("Current PE") +
ylab("Expected Growth in the Next 5 Years") +
ggtitle("Plot of Current PE to Expected Growth") +
theme_classic()
beta2 <- data.frame(pe = beta_pe[(cutoff+1):end],
growth = beta_growth[(cutoff+1):end])
plot(beta2$pe, beta2$growth,
main = paste("Current PE Ratio vs. Expected Growth",
"For Industries with Higher Beta"),
xlab = "Current PE ratio", ylab = "Expected growth (next 5 years)",
col = rgb(200, 50, 50, 100, maxColorValue = 255), pch = 16)
fit4 <- lm(growth ~ pe, data = beta2)
abline(fit4, col = rgb(200, 50, 50, maxColorValue = 255))
summary(fit4)
beta_pe <- clean_data$Current.PE[sorted_beta]
beta_growth <- clean_data$Expected.Growth.Next.5.Years[sorted_beta]
end <- length(beta_pe)
cutoff <- round(end/2)
beta1 <- data.frame(pe = beta_pe[1:cutoff], growth = beta_growth[1:cutoff])
plot(beta1$pe, beta1$growth,
main = paste("Current PE Ratio vs. Expected Growth",
"For Industries with Lower Beta"),
xlab = "Current PE ratio", ylab = "Expected growth (next 5 years)",
col = rgb(50, 50, 200, 100, maxColorValue = 255), pch = 16)
fit3 <- lm(growth ~ pe, data = beta1)
abline(fit3, col = rgb(50, 50, 200, maxColorValue = 255))
summary(fit3)
ggplot(data = clean_data, aes(x = Current.PE,
y = Expected.Growth.Next.5.Years)) +
geom_line(color = "#548edf") + xlab("Current PE") +
ylab("Expected Growth in the Next 5 Years") +
ggtitle("Plot of Current PE to Expected Growth") +
theme_classic()
ggplot(dat3, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity", color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") +
theme_classic()
ggplot(dat4, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity", color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") +
theme_classic()
dat5 <- subset(sorted_pe_growth, sorted_pe >= 100 & sorted_pe < 200)
ggplot(dat5, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity", color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") +
theme_classic()
dat5 <- subset(sorted_pe_growth, sorted_pe >= 100 & sorted_pe < 200)
ggplot(dat5, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity", color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") +
theme_classic()
dat5 <- subset(sorted_pe_growth, sorted_pe >= 100 & sorted_pe < 200)
ggplot(dat5, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity", color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") +
theme_classic()
dat6 <- subset(sorted_pe_growth, sorted_pe < 100)
ggplot(dat6, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity",
color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") + theme_classic()
dat5 <- subset(sorted_pe_growth, sorted_pe >= 100 & sorted_pe < 200)
ggplot(dat5, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity", color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") +
theme_classic()
sorted_pe <- sort(clean_data$Current.PE, decreasing = TRUE,
index.return = TRUE)[[2]]
sort_pe <- sort(clean_data$Current.PE, decreasing = TRUE)
sorted_growth2 <- clean_data$Expected.Growth.Next.5.Years[sorted_pe]
sorted_pe_growth <- data.frame(pe = sort_pe, growth = sorted_growth2)
dat4 <- subset(sorted_pe_growth, sort_pe < 300)
plot(dat4$pe, dat4$growth, main = "Current PE Ratio vs. Expected Growth",
xlab = "Current PE ratio", ylab = "Expected growth (next 5 years)",
col = rgb(200, 50, 200, 100, maxColorValue = 255), pch = 16)
fit2 <- lm(growth ~ pe, data = dat4)
abline(fit2, col = rgb(200, 50, 200, maxColorValue = 255))
summary(fit2)
beta_pe <- clean_data$Current.PE[sorted_beta]
beta_growth <- clean_data$Expected.Growth.Next.5.Years[sorted_beta]
end <- length(beta_pe)
cutoff <- round(end/2)
beta1 <- data.frame(pe = beta_pe[1:cutoff], growth = beta_growth[1:cutoff])
plot(beta1$pe, beta1$growth,
main = paste("Current PE Ratio vs. Expected Growth",
"For Industries with Lower Beta"),
xlab = "Current PE ratio", ylab = "Expected growth (next 5 years)",
col = rgb(50, 50, 200, 100, maxColorValue = 255), pch = 16)
fit3 <- lm(growth ~ pe, data = beta1)
abline(fit3, col = rgb(50, 50, 200, maxColorValue = 255))
summary(fit3)
# Industries with lower beta
print("Industries with lower beta:")
print(clean_data$Industry[sorted_beta][1:cutoff])
# Account for beta when sorting PE ratios and growth by taking the PE ratios
# and growths of industries with higher beta
beta2 <- data.frame(pe = beta_pe[(cutoff+1):end],
growth = beta_growth[(cutoff+1):end])
plot(beta2$pe, beta2$growth,
main = paste("Current PE Ratio vs. Expected Growth",
"For Industries with Higher Beta"),
xlab = "Current PE ratio", ylab = "Expected growth (next 5 years)",
col = rgb(200, 50, 50, 100, maxColorValue = 255), pch = 16)
fit4 <- lm(growth ~ pe, data = beta2)
abline(fit4, col = rgb(200, 50, 50, maxColorValue = 255))
summary(fit4)
# Industries with higher beta
print("Industries with higher beta:")
print(clean_data$Industry[sorted_beta][(cutoff+1):end])
# Graph Current PE to Expected Growth in the Next 5 Years
ggplot(data = clean_data, aes(x = Current.PE,
y = Expected.Growth.Next.5.Years)) +
geom_line(color = "#548edf") + xlab("Current PE") +
ylab("Expected Growth in the Next 5 Years") +
ggtitle("Plot of Current PE to Expected Growth") +
theme_classic()
# Make a histogram of Current PE to Expected Growth for industries with
# pe, p, fulfilling p < 300
ggplot(dat4, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity", color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") +
theme_classic()
# Make a histogram of Current PE to Expected Growth for industries with
# pe, p, fulfilling 100 <= p < 200
dat5 <- subset(sorted_pe_growth, sorted_pe >= 100 & sorted_pe < 200)
ggplot(dat5, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity", color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") +
theme_classic()
ggplot(dat4, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity", color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") + theme_classic()
# Make a histogram of Current PE to Expected Growth for industries with
dat5 <- subset(sorted_pe_growth, sorted_pe >= 100 & sorted_pe < 300)
ggplot(dat5, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity", color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") +
theme_classic()
ggplot(dat6, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity",
color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") + theme_classic()
dat6 <- subset(sorted_pe_growth, sorted_pe < 100)
ggplot(dat6, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity",
color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") + theme_classic()
dat6
dat6 <- subset(sorted_pe_growth, pe < 100)
ggplot(dat6, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity",
color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") + theme_classic()
dat5 <- subset(sorted_pe_growth, pe >= 100 & pe < 300)
ggplot(dat5, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity", color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") +
theme_classic()
dat6 <- subset(sorted_pe_growth, pe < 100)
ggplot(dat6, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity",
color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") + theme_classic()
symbols(industries_only$Current.PE,
industries_only$Expected.Growth.Next.5.Years,
circles = industries_only$Number.of.Firms,
inches = 0.35, fg="white", bg="#facccc8d",
xlab="Current PE", ylab="Expected Growth in 5 Years",
main = "Current PE vs Expected Growth in the Next 5 Years")
text(industries_only$Current.PE, industries_only$Expected.Growth.Next.5.Years,
labels = industries_only$Number.of.Firms, cex = 0.2)
# Make bubble plots of Current PE and Expected Growth in the
# Next 5 Years for different industries accounting for outliers
industry_pe <- unlist(sort(industries_only$Current.PE, decreasing = TRUE))
industry_indices <- unlist(sort(industries_only$Current.PE, decreasing = TRUE,
index.return = TRUE)[[2]])
industry_growth <- industries_only$
Expected.Growth.Next.5.Years[industry_indices]
industry_num_firms <- industries_only$Number.of.Firms[industry_indices]
industry_pe_growth <- data.frame(pe = industry_pe, growth = industry_growth,
num_firms = industry_num_firms)
dat7 <- subset(industry_pe_growth, industry_pe < 150)
symbols(dat7$pe, dat7$growth, circles = dat7$num_firms,
inches=0.35, fg="white", bg="#facccc8d",
xlab="Current PE", ylab="Expected Growth in 5 Years",
main = paste("Current PE Less Than 150 vs",
"Expected Growth in the Next 5 Years"))
text(dat7$pe, dat7$growth, labels = dat7$num_firms, cex = 0.3)
ggplot(data = clean_data, aes(x = Current.PE,
y = Expected.Growth.Next.5.Years)) +
geom_line(color = "#548edf") + xlab("Current PE") +
ylab("Expected Growth in the Next 5 Years") +
ggtitle("Plot of Current PE to Expected Growth") + theme_classic()
ggplot(dat4, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity", color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") + theme_classic()
dat5 <- subset(sorted_pe_growth, pe >= 100 & pe < 300)
ggplot(dat5, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity", color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") + theme_classic()
dat6 <- subset(sorted_pe_growth, pe < 100)
ggplot(dat6, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity",
color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") + theme_classic()
ggplot(dat4, aes(x = pe, y = growth)) + geom_line(color = "#ebcefb") +
geom_bar(position = "identity", stat = "identity", color = "#000000") +
ggtitle("Beta vs Expected Growth Rate") + theme_classic()
symbols(industries_only$Current.PE,
industries_only$Expected.Growth.Next.5.Years,
circles = industries_only$Number.of.Firms,
inches = 0.35, fg="white", bg="#facccc8d",
xlab="Current PE", ylab="Expected Growth in 5 Years",
main = "Current PE vs Expected Growth in the Next 5 Years")
text(industries_only$Current.PE, industries_only$Expected.Growth.Next.5.Years,
labels = industries_only$Number.of.Firms, cex = 0.2)
industry_pe <- unlist(sort(industries_only$Current.PE, decreasing = TRUE))
industry_indices <- unlist(sort(industries_only$Current.PE, decreasing = TRUE,
index.return = TRUE)[[2]])
industry_growth <- industries_only$
Expected.Growth.Next.5.Years[industry_indices]
industry_num_firms <- industries_only$Number.of.Firms[industry_indices]
industry_pe_growth <- data.frame(pe = industry_pe, growth = industry_growth,
num_firms = industry_num_firms)
dat7 <- subset(industry_pe_growth, industry_pe < 150)
symbols(dat7$pe, dat7$growth, circles = dat7$num_firms,
inches=0.35, fg="white", bg="#facccc8d",
xlab="Current PE", ylab="Expected Growth in 5 Years",
main = paste("Current PE Less Than 150 vs",
"Expected Growth in the Next 5 Years"))
text(dat7$pe, dat7$growth, labels = dat7$num_firms, cex = 0.3)
# Graph the scatterplot of unlevered beta's impact on expected growth
reg2 <- lm(Expected.Growth.Next.5.Years ~ Average.Unlevered.Beta +
Current.PE, data = clean_data)
summary(reg2)
ggplot(clean_data, aes(x = Current.PE, y = Expected.Growth.Next.5.Years)) +
geom_point() + xlab("Current PE Ratio") + ylab("Expected Growth (%)") +
ggtitle("Scatterplot of Current PE Ratio vs Expected Growth") +
theme_classic()
ggplot(clean_data, aes(x = Current.PE, y = Expected.Growth.Next.5.Years)) +
geom_point() + xlab("Current PE Ratio") + ylab("Expected Growth (%)") +
geom_abline(aes(slope = unname(coef(reg2)["Current.PE"]),
intercept = unname(coef(reg2)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("Scatterplot of Current PE Ratio vs Expected Growth") +
theme_classic()
log_reg2 <- lm(Expected.Growth.Next.5.Years ~ log(Current.PE) +
Average.Unlevered.Beta, data = clean_data)
summary(log_reg2)
ggplot(clean_data, aes(x = log(Current.PE),
y = Expected.Growth.Next.5.Years)) +
geom_point() + ggtitle("Scatterplot of PE Ratio vs Expected Growth") +
xlab("Current PE Ratio (log)") + ylab("Expected Growth (%)") +
geom_abline(aes(slope = unname(coef(log_reg2)["log(Current.PE)"]),
intercept = unname(coef(log_reg2)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
theme_classic()
indices_no_outliers <- sort(clean_data$Expected.Growth.Next.5.Years,
index.return = TRUE)[[2]]
growth_no_outliers <- unlist(sort(clean_data$Expected.Growth.Next.5.Years))
pe_no_outliers <- clean_data$Current.PE[indices_no_outliers]
dat8 <- data.frame(growth = growth_no_outliers, pe = pe_no_outliers)
dat8 <- subset(dat8, growth_no_outliers > 6.32 & pe_no_outliers < 300)
reg2_no_outliers <- lm(growth ~ pe , data = dat8)
summary(reg2_no_outliers)
ggplot(dat8, aes(x = pe, y = growth)) + theme_classic() +
geom_point() + xlab("Current PE Ratio") + ylab("Expected Growth (%)") +
geom_abline(aes(slope = unname(coef(reg2_no_outliers)["pe"]),
intercept = unname(coef(reg2_no_outliers)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("Current PE Ratio's Impact on Expected Growth")
reg3 <- lm(Expected.Growth.Next.5.Years ~ Average.Unlevered.Beta +
Current.PE + PEG.Ratio, data = clean_data)
summary(reg3)
ggplot(clean_data, aes(x = PEG.Ratio, y = Expected.Growth.Next.5.Years)) +
geom_point() + xlab("Current PE Ratio") + ylab("Expected Growth (%)") +
geom_abline(aes(slope = unname(coef(reg3)["PEG.Ratio"]),
intercept = unname(coef(reg3)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("Current PE Ratio's Impact on Expected Growth") +
theme_classic()
reg4 <- lm(Expected.Growth.Next.5.Years ~ PEG.Ratio, data = clean_data)
summary(reg4)
ggplot(clean_data, aes(x = PEG.Ratio, y = Expected.Growth.Next.5.Years)) +
geom_point(color = rgb(223, 84, 84, 100, maxColorValue = 255)) +
xlab("PEG Ratio") + ylab("Expected Growth (%)") +
geom_abline(aes(slope = unname(coef(reg3)["PEG.Ratio"]),
intercept = unname(coef(reg3)["(Intercept)"])),
color = rgb(84, 233, 233, maxColorValue = 255)) +
geom_abline(aes(slope = unname(coef(reg4)["PEG.Ratio"]),
intercept = unname(coef(reg4)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("PEG Ratio's Impact on Expected Growth") +
coord_cartesian(ylim=c(0,40)) + theme_classic()
peg_no_outliers <- clean_data$PEG.Ratio[indices_no_outliers]
dat9 <- data.frame(growth = growth_no_outliers, peg = peg_no_outliers)
dat9 <- subset(dat9, growth_no_outliers > 6.32 & peg_no_outliers < 2.5 &
!is.na(peg_no_outliers))
reg4_no_outliers <- lm(growth ~ peg, data = dat9)
summary(reg4_no_outliers)
ggplot(dat9, aes(x = peg, y = growth)) + xlab("PEG Ratio") +
ylab("Expected Growth (%)") + coord_cartesian(ylim=c(0,40)) +
geom_point(color = rgb(223, 84, 84, 100, maxColorValue = 255)) +
geom_abline(aes(slope = unname(coef(reg4_no_outliers)["peg"]),
intercept = unname(coef(reg4_no_outliers)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("PEG Ratio's Impact on Expected Growth") + theme_classic()
peg_no_outliers <- clean_data$PEG.Ratio[indices_no_outliers]
dat9 <- data.frame(growth = growth_no_outliers, peg = peg_no_outliers)
dat9 <- subset(dat9, growth > 6.32 & peg < 2.5 & !is.na(peg))
reg4_no_outliers <- lm(growth ~ peg, data = dat9)
summary(reg4_no_outliers)
ggplot(dat9, aes(x = peg, y = growth)) + xlab("PEG Ratio") +
ylab("Expected Growth (%)") + coord_cartesian(ylim=c(0,40)) +
geom_point(color = rgb(223, 84, 84, 100, maxColorValue = 255)) +
geom_abline(aes(slope = unname(coef(reg4_no_outliers)["peg"]),
intercept = unname(coef(reg4_no_outliers)["(Intercept)"])),
color = rgb(223, 84, 84, maxColorValue = 255)) +
ggtitle("PEG Ratio's Impact on Expected Growth") + theme_classic()
